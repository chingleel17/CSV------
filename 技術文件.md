# 技術文件

## 工具名稱
Lark 重複資料檢查網頁工具

## 工具描述
此工具是一個簡易的網頁應用程式，用於檢查 Lark 文件中是否存在重複資料。使用者可以上傳 CSV 文件，動態選擇要檢查的欄位，並在檢查前預覽文件的前 5 行以進行調整。

## 功能
1. **上傳文件**：
   - 使用者可以上傳從 Lark 下載的 CSV 文件。
   - 自動刪除第一欄，並將第二行設為標題行。

2. **動態選擇檢查欄位**：
   - 使用者可以從文件的標題行中選擇要檢查的欄位。
   - 支援多欄位檢查。

3. **文件預覽**：
   - 上傳文件後，顯示文件的前 5 行內容，供使用者確認與調整。

4. **檢查重複資料**：
   - 根據選定的欄位檢查重複資料。
   - 將結果輸出為新的 CSV 文件，供下載。

## 使用方式
1. **上傳文件**：
   - 點擊「上傳文件」按鈕，選擇從 Lark 下載的 CSV 文件。
   - 工具會自動處理文件，刪除第一欄並設置標題行。

2. **檢視與選擇欄位**：
   - 預覽文件的前 5 行內容。
   - 從標題行中選擇要檢查的欄位。

3. **執行檢查**：
   - 點擊「檢查重複資料」按鈕，工具會根據選定的欄位進行檢查。
   - 檢查完成後，提供結果文件的下載連結。

## 程式碼結構
- `app.py`：後端主程式，使用 Flask 框架。
  - 處理文件上傳與檢查邏輯。
  - 提供 API 供前端呼叫。

- `templates/index.html`：前端主頁面。
  - 提供文件上傳、欄位選擇與結果顯示的介面。

- `static/`：靜態資源目錄，包含 CSS 與 JavaScript 文件。

## 環境需求
- Python 3.7 或以上版本。
- 所需套件：
  - Flask
  - pandas
  - numpy

## 安裝與執行
1. 安裝 Python。
2. 安裝所需套件：
   ```bash
   pip install -r requirements.txt
   ```
3. 啟動伺服器：
   ```bash
   python app.py
   ```
4. 開啟瀏覽器並訪問 `http://127.0.0.1:5000`。

## 注意事項
- 請確保上傳的 CSV 文件格式正確，否則可能導致程式錯誤。
- 輸出文件將保存到伺服器的臨時目錄，請及時下載。

## 未來改進
- 支援直接從 Lark API 獲取文件（若適用）。
- 增加多語言支援。
- 提供更詳細的檢查報告，例如重複資料的統計資訊。